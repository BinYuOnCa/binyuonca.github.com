<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"binyuonca.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="This is my assignment of final project of IBM online course Machine Learning with Python via Coursera. In this notebook we will build a classifier to predict whether a loan case will be paid off or no">
<meta property="og:type" content="article">
<meta property="og:title" content="Classification with Python">
<meta property="og:url" content="https://binyuonca.github.io/2020/07/08/Classification-with-Python/index.html">
<meta property="og:site_name" content="From Backend Engineer to Data Scientist">
<meta property="og:description" content="This is my assignment of final project of IBM online course Machine Learning with Python via Coursera. In this notebook we will build a classifier to predict whether a loan case will be paid off or no">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://binyuonca.github.io/2020/07/08/Classification-with-Python/output_19_0.png">
<meta property="og:image" content="https://binyuonca.github.io/2020/07/08/Classification-with-Python/output_20_0.png">
<meta property="og:image" content="https://binyuonca.github.io/2020/07/08/Classification-with-Python/output_23_0.png">
<meta property="og:image" content="https://binyuonca.github.io/2020/07/08/Classification-with-Python/output_57_0.png">
<meta property="og:image" content="https://binyuonca.github.io/2020/07/08/Classification-with-Python/loanTree.png">
<meta property="article:published_time" content="2020-07-08T21:11:50.000Z">
<meta property="article:modified_time" content="2020-07-13T05:00:27.635Z">
<meta property="article:author" content="Bin Yu">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Classification">
<meta property="article:tag" content="Pandas">
<meta property="article:tag" content="seaborn">
<meta property="article:tag" content="Coursera">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://binyuonca.github.io/2020/07/08/Classification-with-Python/output_19_0.png">

<link rel="canonical" href="https://binyuonca.github.io/2020/07/08/Classification-with-Python/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Classification with Python | From Backend Engineer to Data Scientist</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-171550981-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-171550981-1');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">From Backend Engineer to Data Scientist</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/BinYuOnCa" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://binyuonca.github.io/2020/07/08/Classification-with-Python/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/Ben_Marathon_Mississauga.gif">
      <meta itemprop="name" content="Bin Yu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="From Backend Engineer to Data Scientist">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Classification with Python
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-08 17:11:50" itemprop="dateCreated datePublished" datetime="2020-07-08T17:11:50-04:00">2020-07-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-13 01:00:27" itemprop="dateModified" datetime="2020-07-13T01:00:27-04:00">2020-07-13</time>
              </span>

          
            <span id="/2020/07/08/Classification-with-Python/" class="post-meta-item leancloud_visitors" data-flag-title="Classification with Python" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="firestore-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2020/07/08/Classification-with-Python/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/07/08/Classification-with-Python/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>This is my assignment of final project of <a href="https://www.coursera.org/learn/machine-learning-with-python/home/welcome" target="_blank" rel="noopener">IBM online course Machine Learning with Python</a> via Coursera.</p>
<p>In this notebook we will build a classifier to predict whether a loan case will be paid off or not. We will load a historical dataset from previous loan applications, clean the data, and apply different classification algorithm on the data. The results is reported as the accuracy of each classifier, using the following metrics when these are applicable.</p>
<table>
<thead>
<tr>
<th>Algorithms</th>
<th>Evaluation</th>
</tr>
</thead>
<tbody><tr>
<td>K Nearest Neibhbor (KNN) <br> Decision Tree (DT) <br> Support Vector Machine (SVM) <br> Logistic Regression (LR)</td>
<td>Jaccard index <br>F1-score <br> LogLoass</td>
</tr>
</tbody></table>
<a id="more"></a>

<p><strong>Table of Contents</strong></p>
<ul>
<li><a href="#1-Environment-And-Dataset">1. Environment And Dataset</a><ul>
<li><a href="#1-1-About-Dataset">1.1. About Dataset</a></li>
<li><a href="#1-2-Load-Data-From-Csv-File">1.2. Load Data From CSV File</a></li>
<li><a href="#1-3-Convert-To-Date-Time-Object">1.3. Convert To Date Time Object</a></li>
</ul>
</li>
<li><a href="#2-Pre-processing-With-Data-Visualization">2. Pre-processing With Data Visualization</a><ul>
<li><a href="#2-1-Visulaition-The-Data">2.1. Visulaition The Data</a></li>
<li><a href="#2-2-Categorical---Encoding">2.2. Categorical Encoding</a><ul>
<li><a href="#2-2-1-Gender">2.2.1. Gender</a>-</li>
<li><a href="#2-2-2-Education">2.2.2. Education</a></li>
</ul>
</li>
<li><a href="#2-3-Feature-Selection">2.3. Feature Selection</a></li>
<li><a href="#2-4-Normalize-Data">2.4. Normalize Data</a></li>
</ul>
</li>
<li><a href="#3-Classification">3. Classification</a><ul>
<li><a href="#3-1-K-Nearest-Neighborknn">3.1. K Nearest Neighbor(KNN)</a></li>
<li><a href="#3-2-Decision-Tree">3.2. Decision Tree</a></li>
<li><a href="#3-3-Support-Vector-Machine">3.3. Support Vector Machine</a></li>
<li><a href="#3-4-Logistic-Regression">3.4. Logistic Regression</a></li>
</ul>
</li>
<li><a href="#4-Model-Evaluation-Using-Test-Data-Set">4. Model Evaluation Using Test Data Set</a><ul>
<li><a href="#4-1-Load-Test-Data-Set-For-Evaluation">4.1. Load Test Data Set For Evaluation</a></li>
<li><a href="#4-2-Pre-processing-Test-Data-Set">4.2. Pre-processing Test Data Set</a></li>
</ul>
</li>
<li><a href="#5-summary">5. Summary</a></li>
</ul>
<p>In this notebook we try to practice all the classification algorithms that we learned in this course.</p>
<p>We load a dataset using Pandas library, and apply the following algorithms, and find the best one for this specific dataset by accuracy evaluation methods.</p>
<ul>
<li>K Nearest Neibhbor (KNN)</li>
<li>Decision Tree (DT)</li>
<li>Support Vector Machine (SVM)</li>
<li>Logistic Regression (LR)</li>
</ul>
<h1 id="1-Environment-And-Dataset"><a href="#1-Environment-And-Dataset" class="headerlink" title="1. Environment And Dataset"></a>1. Environment And Dataset</h1><p>Lets first load required libraries:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib.ticker <span class="keyword">import</span> NullFormatter</span><br><span class="line"><span class="keyword">import</span> matplotlib.ticker <span class="keyword">as</span> ticker</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line">warnings.filterwarnings(<span class="string">'ignore'</span>)</span><br><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure>

<h2 id="1-1-About-Dataset"><a href="#1-1-About-Dataset" class="headerlink" title="1.1. About Dataset"></a>1.1. About Dataset</h2><p>This dataset is about past loans. The <strong>Loan_train.csv</strong> data set includes details of 346 customers whose loan are already paid off or defaulted. It includes following fields:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>Loan_status</td>
<td>Whether a loan is paid off on in collection</td>
</tr>
<tr>
<td>Principal</td>
<td>Basic principal loan amount at the</td>
</tr>
<tr>
<td>Terms</td>
<td>Origination terms which can be weekly (7 days), biweekly, and monthly payoff schedule</td>
</tr>
<tr>
<td>Effective_date</td>
<td>When the loan got originated and took effects</td>
</tr>
<tr>
<td>Due_date</td>
<td>Since it’s one-time payoff schedule, each loan has one single due date</td>
</tr>
<tr>
<td>Age</td>
<td>Age of applicant</td>
</tr>
<tr>
<td>Education</td>
<td>Education of applicant</td>
</tr>
<tr>
<td>Gender</td>
<td>The gender of applicant</td>
</tr>
</tbody></table>
<p>Lets download the dataset</p>
<p>!wget -O loan_train.csv <a href="https://s3-api.us-geo.objectstorage.softlayer.net/cf-courses-data/CognitiveClass/ML0101ENv3/labs/loan_train.csv" target="_blank" rel="noopener">https://s3-api.us-geo.objectstorage.softlayer.net/cf-courses-data/CognitiveClass/ML0101ENv3/labs/loan_train.csv</a></p>
<h2 id="1-2-Load-Data-From-CSV-File"><a href="#1-2-Load-Data-From-CSV-File" class="headerlink" title="1.2. Load Data From CSV File"></a>1.2. Load Data From CSV File</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">'loan_train.csv'</span>)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>loan_status</th>
      <th>Principal</th>
      <th>terms</th>
      <th>effective_date</th>
      <th>due_date</th>
      <th>age</th>
      <th>education</th>
      <th>Gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>9/8/2016</td>
      <td>10/7/2016</td>
      <td>45</td>
      <td>High School or Below</td>
      <td>male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>9/8/2016</td>
      <td>10/7/2016</td>
      <td>33</td>
      <td>Bechalor</td>
      <td>female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>15</td>
      <td>9/8/2016</td>
      <td>9/22/2016</td>
      <td>27</td>
      <td>college</td>
      <td>male</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>4</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>9/9/2016</td>
      <td>10/8/2016</td>
      <td>28</td>
      <td>college</td>
      <td>female</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>6</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>9/9/2016</td>
      <td>10/8/2016</td>
      <td>29</td>
      <td>college</td>
      <td>male</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.shape</span><br></pre></td></tr></table></figure>




<pre><code>(346, 10)</code></pre><h2 id="1-3-Convert-To-Date-Time-Object"><a href="#1-3-Convert-To-Date-Time-Object" class="headerlink" title="1.3. Convert To Date Time Object"></a>1.3. Convert To Date Time Object</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'due_date'</span>] = pd.to_datetime(df[<span class="string">'due_date'</span>])</span><br><span class="line">df[<span class="string">'effective_date'</span>] = pd.to_datetime(df[<span class="string">'effective_date'</span>])</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>loan_status</th>
      <th>Principal</th>
      <th>terms</th>
      <th>effective_date</th>
      <th>due_date</th>
      <th>age</th>
      <th>education</th>
      <th>Gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-08</td>
      <td>2016-10-07</td>
      <td>45</td>
      <td>High School or Below</td>
      <td>male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-08</td>
      <td>2016-10-07</td>
      <td>33</td>
      <td>Bechalor</td>
      <td>female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>15</td>
      <td>2016-09-08</td>
      <td>2016-09-22</td>
      <td>27</td>
      <td>college</td>
      <td>male</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>4</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-09</td>
      <td>2016-10-08</td>
      <td>28</td>
      <td>college</td>
      <td>female</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>6</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-09</td>
      <td>2016-10-08</td>
      <td>29</td>
      <td>college</td>
      <td>male</td>
    </tr>
  </tbody>
</table>
</div>



<h1 id="2-Pre-processing-With-Data-Visualization"><a href="#2-Pre-processing-With-Data-Visualization" class="headerlink" title="2. Pre-processing With Data Visualization"></a>2. Pre-processing With Data Visualization</h1><p>Libs used in this section.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br></pre></td></tr></table></figure>
<h2 id="2-1-Visulaition-The-Data"><a href="#2-1-Visulaition-The-Data" class="headerlink" title="2.1. Visulaition The Data"></a>2.1. Visulaition The Data</h2><p>Let’s see how many of each class is in our data set </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'loan_status'</span>].value_counts()</span><br></pre></td></tr></table></figure>




<pre><code>PAIDOFF       260
COLLECTION     86
Name: loan_status, dtype: int64</code></pre><p>260 people have paid off the loan on time while 86 have gone into collection </p>
<p>Lets plot some columns to underestand data better:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Please install seborn libary if you did not have done so.</span><br><span class="line"># notice: installing seaborn might takes a few minutes.</span><br><span class="line">!conda install -c anaconda seaborn -y</span><br></pre></td></tr></table></figure>
<p>Let’s see the Loan status of different pricipal, per gender.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bins = np.linspace(df.Principal.min(), df.Principal.max(), <span class="number">10</span>)</span><br><span class="line">g = sns.FacetGrid(df, col=<span class="string">"Gender"</span>, hue=<span class="string">"loan_status"</span>, palette=<span class="string">"Set1"</span>, col_wrap=<span class="number">2</span>)</span><br><span class="line">g.map(plt.hist, <span class="string">'Principal'</span>, bins=bins, ec=<span class="string">"k"</span>)</span><br><span class="line"></span><br><span class="line">g.axes[<span class="number">-1</span>].legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<!-- [png](/images/output_19_0.png) -->

<img src="/2020/07/08/Classification-with-Python/output_19_0.png" class="" title="Status by Principal and Gender">

<p>Let’s see the Loan status of different age, per gender.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bins = np.linspace(df.age.min(), df.age.max(), <span class="number">10</span>)</span><br><span class="line">g = sns.FacetGrid(df, col=<span class="string">"Gender"</span>, hue=<span class="string">"loan_status"</span>, palette=<span class="string">"Set1"</span>, col_wrap=<span class="number">2</span>)</span><br><span class="line">g.map(plt.hist, <span class="string">'age'</span>, bins=bins, ec=<span class="string">"k"</span>)</span><br><span class="line"></span><br><span class="line">g.axes[<span class="number">-1</span>].legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<!-- ![png](/images/output_20_0.png) -->
<img src="/2020/07/08/Classification-with-Python/output_20_0.png" class="" title="Status by age and Gender">


<p>Lets look at the day of the week people get the loan. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'dayofweek'</span>] = df[<span class="string">'effective_date'</span>].dt.dayofweek</span><br><span class="line">bins = np.linspace(df.dayofweek.min(), df.dayofweek.max(), <span class="number">10</span>)</span><br><span class="line">g = sns.FacetGrid(df, col=<span class="string">"Gender"</span>, hue=<span class="string">"loan_status"</span>, palette=<span class="string">"Set1"</span>, col_wrap=<span class="number">2</span>)</span><br><span class="line">g.map(plt.hist, <span class="string">'dayofweek'</span>, bins=bins, ec=<span class="string">"k"</span>)</span><br><span class="line">g.axes[<span class="number">-1</span>].legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<!--  ![png](/images/output_23_0.png) -->
<img src="/2020/07/08/Classification-with-Python/output_23_0.png" class="" title="Day of week">

<p>We see that people who get the loan at the end of the week dont pay it off, so lets use Feature binarization to set a threshold values less then day 4 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'weekend'</span>] = df[<span class="string">'dayofweek'</span>].apply(<span class="keyword">lambda</span> x: <span class="number">1</span> <span class="keyword">if</span> (x&gt;<span class="number">3</span>)  <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>loan_status</th>
      <th>Principal</th>
      <th>terms</th>
      <th>effective_date</th>
      <th>due_date</th>
      <th>age</th>
      <th>education</th>
      <th>Gender</th>
      <th>dayofweek</th>
      <th>weekend</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-08</td>
      <td>2016-10-07</td>
      <td>45</td>
      <td>High School or Below</td>
      <td>male</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-08</td>
      <td>2016-10-07</td>
      <td>33</td>
      <td>Bechalor</td>
      <td>female</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>15</td>
      <td>2016-09-08</td>
      <td>2016-09-22</td>
      <td>27</td>
      <td>college</td>
      <td>male</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>4</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-09</td>
      <td>2016-10-08</td>
      <td>28</td>
      <td>college</td>
      <td>female</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>6</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-09</td>
      <td>2016-10-08</td>
      <td>29</td>
      <td>college</td>
      <td>male</td>
      <td>4</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>


<h2 id="2-2-Categorical-Encoding"><a href="#2-2-Categorical-Encoding" class="headerlink" title="2.2. Categorical Encoding"></a>2.2. Categorical Encoding</h2><p>For categorical variables, we need convert them into numeric format (encoding) to fit in our Machine Learning algorithms. Whereas there are many method to implement, we introduce two common approaches here, Label Encoding and One Hot Encoding, for feature gender and education here, repspctively. </p>
<p>You may find more information here: <a href="https://pbpython.com/categorical-encoding.html" target="_blank" rel="noopener">Guide to Encoding Categorical Values in Python</a></p>
<h3 id="2-2-1-Gender"><a href="#2-2-1-Gender" class="headerlink" title="2.2.1. Gender"></a>2.2.1. Gender</h3><p>Lets look at gender first:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby([<span class="string">'Gender'</span>])[<span class="string">'loan_status'</span>].value_counts(normalize=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>




<pre><code>Gender  loan_status
female  PAIDOFF        0.865385
        COLLECTION     0.134615
male    PAIDOFF        0.731293
        COLLECTION     0.268707
Name: loan_status, dtype: float64</code></pre><p>86 % of female pay there loans while only 73 % of males pay there loan</p>
<p>Lets convert male to 0 and female to 1:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'Gender'</span>].replace(to_replace=[<span class="string">'male'</span>,<span class="string">'female'</span>], value=[<span class="number">0</span>,<span class="number">1</span>],inplace=<span class="literal">True</span>)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>loan_status</th>
      <th>Principal</th>
      <th>terms</th>
      <th>effective_date</th>
      <th>due_date</th>
      <th>age</th>
      <th>education</th>
      <th>Gender</th>
      <th>dayofweek</th>
      <th>weekend</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-08</td>
      <td>2016-10-07</td>
      <td>45</td>
      <td>High School or Below</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-08</td>
      <td>2016-10-07</td>
      <td>33</td>
      <td>Bechalor</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>15</td>
      <td>2016-09-08</td>
      <td>2016-09-22</td>
      <td>27</td>
      <td>college</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>4</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-09</td>
      <td>2016-10-08</td>
      <td>28</td>
      <td>college</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>6</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-09</td>
      <td>2016-10-08</td>
      <td>29</td>
      <td>college</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



<h3 id="2-2-2-Education"><a href="#2-2-2-Education" class="headerlink" title="2.2.2. Education"></a>2.2.2. Education</h3><p>For education, there are four different values in data set, we will apply One Hot Encoding to this feature.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby([<span class="string">'education'</span>])[<span class="string">'loan_status'</span>].value_counts(normalize=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>




<pre><code>education             loan_status
Bechalor              PAIDOFF        0.750000
                      COLLECTION     0.250000
High School or Below  PAIDOFF        0.741722
                      COLLECTION     0.258278
Master or Above       COLLECTION     0.500000
                      PAIDOFF        0.500000
college               PAIDOFF        0.765101
                      COLLECTION     0.234899
Name: loan_status, dtype: float64</code></pre><p><strong>Befor One Hot Encoding</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>loan_status</th>
      <th>Principal</th>
      <th>terms</th>
      <th>effective_date</th>
      <th>due_date</th>
      <th>age</th>
      <th>education</th>
      <th>Gender</th>
      <th>dayofweek</th>
      <th>weekend</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-08</td>
      <td>2016-10-07</td>
      <td>45</td>
      <td>High School or Below</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-08</td>
      <td>2016-10-07</td>
      <td>33</td>
      <td>Bechalor</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>15</td>
      <td>2016-09-08</td>
      <td>2016-09-22</td>
      <td>27</td>
      <td>college</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>4</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-09</td>
      <td>2016-10-08</td>
      <td>28</td>
      <td>college</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>6</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-09</td>
      <td>2016-10-08</td>
      <td>29</td>
      <td>college</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.describe()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>Principal</th>
      <th>terms</th>
      <th>age</th>
      <th>Gender</th>
      <th>dayofweek</th>
      <th>weekend</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>346.000000</td>
      <td>346.000000</td>
      <td>346.000000</td>
      <td>346.000000</td>
      <td>346.000000</td>
      <td>346.000000</td>
      <td>346.000000</td>
      <td>346.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>202.167630</td>
      <td>202.167630</td>
      <td>943.641618</td>
      <td>22.653179</td>
      <td>30.939306</td>
      <td>0.150289</td>
      <td>3.682081</td>
      <td>0.592486</td>
    </tr>
    <tr>
      <th>std</th>
      <td>115.459715</td>
      <td>115.459715</td>
      <td>109.425530</td>
      <td>7.991006</td>
      <td>6.039418</td>
      <td>0.357872</td>
      <td>2.614912</td>
      <td>0.492084</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>300.000000</td>
      <td>7.000000</td>
      <td>18.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>107.250000</td>
      <td>107.250000</td>
      <td>900.000000</td>
      <td>15.000000</td>
      <td>27.000000</td>
      <td>0.000000</td>
      <td>0.250000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>204.500000</td>
      <td>204.500000</td>
      <td>1000.000000</td>
      <td>30.000000</td>
      <td>30.000000</td>
      <td>0.000000</td>
      <td>5.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>298.750000</td>
      <td>298.750000</td>
      <td>1000.000000</td>
      <td>30.000000</td>
      <td>35.000000</td>
      <td>0.000000</td>
      <td>6.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>399.000000</td>
      <td>399.000000</td>
      <td>1000.000000</td>
      <td>30.000000</td>
      <td>51.000000</td>
      <td>1.000000</td>
      <td>6.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">features = [<span class="string">'Principal'</span>,<span class="string">'terms'</span>,<span class="string">'age'</span>,<span class="string">'Gender'</span>,<span class="string">'education'</span>]</span><br><span class="line">df[features].head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Principal</th>
      <th>terms</th>
      <th>age</th>
      <th>Gender</th>
      <th>education</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>30</td>
      <td>45</td>
      <td>0</td>
      <td>High School or Below</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000</td>
      <td>30</td>
      <td>33</td>
      <td>1</td>
      <td>Bechalor</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000</td>
      <td>15</td>
      <td>27</td>
      <td>0</td>
      <td>college</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000</td>
      <td>30</td>
      <td>28</td>
      <td>1</td>
      <td>college</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000</td>
      <td>30</td>
      <td>29</td>
      <td>0</td>
      <td>college</td>
    </tr>
  </tbody>
</table>
</div>



<p><strong>One Hot Encoding</strong></p>
<p>Use One Hot Encoding technique to conver categorical varables to binary variables and append them to the feature Data Frame. </p>
<p>Here we use pandas function <strong>get_dummies</strong>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Feature = df[[<span class="string">'Principal'</span>,<span class="string">'terms'</span>,<span class="string">'age'</span>,<span class="string">'Gender'</span>,<span class="string">'weekend'</span>]]</span><br><span class="line">Feature = pd.concat([Feature,pd.get_dummies(df[<span class="string">'education'</span>])], axis=<span class="number">1</span>)</span><br><span class="line">Feature.drop([<span class="string">'Master or Above'</span>], axis = <span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">Feature.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Principal</th>
      <th>terms</th>
      <th>age</th>
      <th>Gender</th>
      <th>weekend</th>
      <th>Bechalor</th>
      <th>High School or Below</th>
      <th>college</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>30</td>
      <td>45</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000</td>
      <td>30</td>
      <td>33</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000</td>
      <td>15</td>
      <td>27</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000</td>
      <td>30</td>
      <td>28</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000</td>
      <td>30</td>
      <td>29</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



<h2 id="2-3-Feature-Selection"><a href="#2-3-Feature-Selection" class="headerlink" title="2.3. Feature Selection"></a>2.3. Feature Selection</h2><p>Lets defind feature sets, X:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X = Feature</span><br><span class="line">X[<span class="number">0</span>:<span class="number">5</span>]</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Principal</th>
      <th>terms</th>
      <th>age</th>
      <th>Gender</th>
      <th>weekend</th>
      <th>Bechalor</th>
      <th>High School or Below</th>
      <th>college</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>30</td>
      <td>45</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1000</td>
      <td>30</td>
      <td>33</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000</td>
      <td>15</td>
      <td>27</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000</td>
      <td>30</td>
      <td>28</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1000</td>
      <td>30</td>
      <td>29</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



<p>What are our lables?</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y = df[<span class="string">'loan_status'</span>].values</span><br><span class="line">y[<span class="number">0</span>:<span class="number">5</span>]</span><br></pre></td></tr></table></figure>




<pre><code>array([&apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;],
      dtype=object)</code></pre><h2 id="2-4-Normalize-Data"><a href="#2-4-Normalize-Data" class="headerlink" title="2.4. Normalize Data"></a>2.4. Normalize Data</h2><p>Data Standardization give data zero mean and unit variance (technically should be done after train test split )</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X= preprocessing.StandardScaler().fit(X).transform(X)</span><br><span class="line">X[<span class="number">0</span>:<span class="number">5</span>]</span><br></pre></td></tr></table></figure>




<pre><code>array([[ 0.51578458,  0.92071769,  2.33152555, -0.42056004, -1.20577805,
        -0.38170062,  1.13639374, -0.86968108],
       [ 0.51578458,  0.92071769,  0.34170148,  2.37778177, -1.20577805,
         2.61985426, -0.87997669, -0.86968108],
       [ 0.51578458, -0.95911111, -0.65321055, -0.42056004, -1.20577805,
        -0.38170062, -0.87997669,  1.14984679],
       [ 0.51578458,  0.92071769, -0.48739188,  2.37778177,  0.82934003,
        -0.38170062, -0.87997669,  1.14984679],
       [ 0.51578458,  0.92071769, -0.3215732 , -0.42056004,  0.82934003,
        -0.38170062, -0.87997669,  1.14984679]])</code></pre><h1 id="3-Classification"><a href="#3-Classification" class="headerlink" title="3. Classification"></a>3. Classification</h1><p>Now, it is your turn, use the training set to build an accurate model. Then use the test set to report the accuracy of the model<br>You should use the following algorithm:</p>
<ul>
<li>K Nearest Neighbor(KNN)</li>
<li>Decision Tree</li>
<li>Support Vector Machine</li>
<li>Logistic Regression</li>
</ul>
<!---
__ Notice:__ 
- You can go above and change the pre-processing, feature selection, feature-extraction, and so on, to make a better model.
- You should use either scikit-learn, Scipy or Numpy libraries for developing the classification algorithms.
- You should include the code of the algorithm in the following cells.
--->

<p>Common Libararies Needed for all models</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split <span class="keyword">as</span> split</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics</span><br></pre></td></tr></table></figure>

<h2 id="3-1-K-Nearest-Neighbor-KNN"><a href="#3-1-K-Nearest-Neighbor-KNN" class="headerlink" title="3.1. K Nearest Neighbor(KNN)"></a>3.1. K Nearest Neighbor(KNN)</h2><p>Notice: You should find the best k to build the model with the best accuracy.  </p>
<p><strong>warning:</strong> You should not use the <strong>loan_test.csv</strong> for finding the best k, however, you can split your train_loan.csv into train and test to find the best <strong>k</strong>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">X_train, X_test, y_train, y_test = split( X, y, test_size = <span class="number">0.2</span> , random_state = <span class="number">4</span> )</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Train_Pre_Accurany</span><span class="params">(k)</span>:</span></span><br><span class="line">    <span class="comment">#Train Model and Predict  </span></span><br><span class="line"></span><br><span class="line">    neigh = KNeighborsClassifier(n_neighbors = k).fit(X_train,y_train)</span><br><span class="line">    yhat = neigh.predict(X_test)</span><br><span class="line"></span><br><span class="line"><span class="comment">#     Train_Accuracy = metrics.accuracy_score(y_train, neigh.predict(X_train))</span></span><br><span class="line">    Test_Accuracy = metrics.accuracy_score(y_test, yhat)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> Test_Accuracy</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find best k according to test_accurancy </span></span><br><span class="line">Ks = <span class="number">15</span></span><br><span class="line">Test_accuracies = np.zeros(Ks)</span><br><span class="line">best_accuracy = <span class="number">0</span> </span><br><span class="line">best_k = <span class="number">0</span> </span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">1</span>, Ks):</span><br><span class="line">    accuracy = Train_Pre_Accurany(k)</span><br><span class="line">    Test_accuracies[k] = accuracy</span><br><span class="line">    <span class="keyword">if</span> accuracy &gt; best_accuracy:</span><br><span class="line">        best_accuracy = accuracy</span><br><span class="line">        best_k = k </span><br><span class="line"></span><br><span class="line">best_k</span><br></pre></td></tr></table></figure>




<pre><code>7</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Test_accuracies</span><br></pre></td></tr></table></figure>




<pre><code>array([0.        , 0.67142857, 0.65714286, 0.71428571, 0.68571429,
       0.75714286, 0.71428571, 0.78571429, 0.75714286, 0.75714286,
       0.67142857, 0.7       , 0.72857143, 0.7       , 0.7       ])</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(range(<span class="number">1</span>,Ks), Test_accuracies[<span class="number">1</span>:], <span class="string">'b'</span>)</span><br><span class="line">plt.annotate(<span class="string">'Best K:&#123;&#125;, accuracy:&#123;:.3f&#125;'</span>.format(best_k, best_accuracy),</span><br><span class="line">             xy=(best_k, best_accuracy), xytext = ( best_k + <span class="number">2</span>, best_accuracy),</span><br><span class="line">             arrowprops=dict(facecolor=<span class="string">'black'</span>, shrink=<span class="number">0.1</span>)</span><br><span class="line">            )</span><br><span class="line">line = [(best_k, best_k), (min(Test_accuracies[<span class="number">1</span>:]), best_accuracy),<span class="string">'r'</span>,]</span><br><span class="line">plt.plot(*line)</span><br><span class="line"></span><br><span class="line">plt.ylabel(<span class="string">'Accuracy'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'K'</span>)</span><br><span class="line">plt.show();</span><br></pre></td></tr></table></figure>


<!-- ![png](/images/output_57_0.png) -->
<img src="/2020/07/08/Classification-with-Python/output_57_0.png" class="" title="Best K">


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">best_k</span><br></pre></td></tr></table></figure>


<pre><code>7</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kNeighbor = KNeighborsClassifier(n_neighbors = best_k).fit(X_train,y_train)</span><br><span class="line">sum(y_test == kNeighbor.predict(X_test))/len(y_test)</span><br></pre></td></tr></table></figure>




<pre><code>0.7857142857142857</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kNeighbor</span><br></pre></td></tr></table></figure>




<pre><code>KNeighborsClassifier(algorithm=&apos;auto&apos;, leaf_size=30, metric=&apos;minkowski&apos;,
                     metric_params=None, n_jobs=None, n_neighbors=7, p=2,
                     weights=&apos;uniform&apos;)</code></pre><h2 id="3-2-Decision-Tree"><a href="#3-2-Decision-Tree" class="headerlink" title="3.2. Decision Tree"></a>3.2. Decision Tree</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">loanTree = DecisionTreeClassifier(criterion=<span class="string">"entropy"</span>, max_depth = <span class="number">4</span>)</span><br><span class="line">loanTree.fit(X_train,y_train)</span><br><span class="line"></span><br><span class="line">yhat = loanTree.predict(X_train)</span><br><span class="line">sum(y_train == yhat )/len(y_train)</span><br></pre></td></tr></table></figure>




<pre><code>0.7463768115942029</code></pre><p><strong>Visualization</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.externals.six <span class="keyword">import</span> StringIO</span><br><span class="line"><span class="keyword">import</span> pydotplus</span><br><span class="line"><span class="keyword">import</span> matplotlib.image <span class="keyword">as</span> mpimg</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">dot_data = StringIO()</span><br><span class="line">filename = <span class="string">'loanTree.png'</span></span><br><span class="line">featureNames = Feature.columns</span><br><span class="line">targetNames = [<span class="string">'PAIDOFF'</span>, <span class="string">'COLLECTION'</span>]</span><br><span class="line"></span><br><span class="line">out = tree.export_graphviz(loanTree, feature_names = featureNames, out_file = dot_data,</span><br><span class="line">                           class_names=np.unique(y), filled=<span class="literal">True</span>,</span><br><span class="line">                           special_characters=<span class="literal">True</span>, rotate=<span class="literal">False</span>,</span><br><span class="line">                          )</span><br><span class="line"></span><br><span class="line">                         </span><br><span class="line">graph = pydotplus.graph_from_dot_data(dot_data.getvalue())</span><br><span class="line">graph.write_png(filename)</span><br><span class="line">                           </span><br><span class="line">img = mpimg.imread(filename)</span><br><span class="line">plt.figure(figsize=(<span class="number">100</span>,<span class="number">200</span>))</span><br><span class="line">plt.imshow(img, interpolation=<span class="string">'nearest'</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.image.AxesImage at 0x7f9e2f1b37f0&gt;</code></pre><!-- ![png](/images/loanTree.png) -->
<img src="/2020/07/08/Classification-with-Python/loanTree.png" class="" title="Desicion Tree Visualization">

<h2 id="3-3-Support-Vector-Machine"><a href="#3-3-Support-Vector-Machine" class="headerlink" title="3.3. Support Vector Machine"></a>3.3. Support Vector Machine</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</span><br><span class="line">svm_Model = svm.SVC(kernel=<span class="string">'rbf'</span>)</span><br><span class="line">svm_Model.fit(X_train, y_train) </span><br><span class="line"></span><br><span class="line">yhat = svm_Model.predict(X_test)</span><br><span class="line">sum(y_test == yhat)/len(y_test)</span><br></pre></td></tr></table></figure>




<pre><code>0.7428571428571429</code></pre><h2 id="3-4-Logistic-Regression"><a href="#3-4-Logistic-Regression" class="headerlink" title="3.4. Logistic Regression"></a>3.4. Logistic Regression</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#from sklearn.linear_model import LogistricRegression</span></span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">LR_Model = LogisticRegression( C = <span class="number">0.01</span>, solver = <span class="string">'liblinear'</span>)</span><br><span class="line">LR_Model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">lrYhat = LR_Model.predict(X_test)</span><br><span class="line">lrYhat_prob = LR_Model.predict_proba(X_test)</span><br><span class="line">sum(lrYhat == y_test)/len(y_test)</span><br></pre></td></tr></table></figure>




<pre><code>0.6857142857142857</code></pre><h1 id="4-Model-Evaluation-Using-Test-Data-Set"><a href="#4-Model-Evaluation-Using-Test-Data-Set" class="headerlink" title="4. Model Evaluation Using Test Data Set"></a>4. Model Evaluation Using Test Data Set</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> jaccard_similarity_score</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> f1_score</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> log_loss</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> jaccard_score</span><br></pre></td></tr></table></figure>

<p>First, download and load the test set:</p>
<p>!wget -O loan_test.csv <a href="https://s3-api.us-geo.objectstorage.softlayer.net/cf-courses-data/CognitiveClass/ML0101ENv3/labs/loan_test.csv" target="_blank" rel="noopener">https://s3-api.us-geo.objectstorage.softlayer.net/cf-courses-data/CognitiveClass/ML0101ENv3/labs/loan_test.csv</a></p>
<h2 id="4-1-Load-Test-Data-Set-For-Evaluation"><a href="#4-1-Load-Test-Data-Set-For-Evaluation" class="headerlink" title="4.1. Load Test Data Set For Evaluation"></a>4.1. Load Test Data Set For Evaluation</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">test_df = pd.read_csv(<span class="string">'loan_test.csv'</span>)</span><br><span class="line">test_df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>loan_status</th>
      <th>Principal</th>
      <th>terms</th>
      <th>effective_date</th>
      <th>due_date</th>
      <th>age</th>
      <th>education</th>
      <th>Gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>9/8/2016</td>
      <td>10/7/2016</td>
      <td>50</td>
      <td>Bechalor</td>
      <td>female</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>5</td>
      <td>PAIDOFF</td>
      <td>300</td>
      <td>7</td>
      <td>9/9/2016</td>
      <td>9/15/2016</td>
      <td>35</td>
      <td>Master or Above</td>
      <td>male</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21</td>
      <td>21</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>9/10/2016</td>
      <td>10/9/2016</td>
      <td>43</td>
      <td>High School or Below</td>
      <td>female</td>
    </tr>
    <tr>
      <th>3</th>
      <td>24</td>
      <td>24</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>9/10/2016</td>
      <td>10/9/2016</td>
      <td>26</td>
      <td>college</td>
      <td>male</td>
    </tr>
    <tr>
      <th>4</th>
      <td>35</td>
      <td>35</td>
      <td>PAIDOFF</td>
      <td>800</td>
      <td>15</td>
      <td>9/11/2016</td>
      <td>9/25/2016</td>
      <td>29</td>
      <td>Bechalor</td>
      <td>male</td>
    </tr>
  </tbody>
</table>
</div>



<h2 id="4-2-Pre-processing-Test-Data-Set"><a href="#4-2-Pre-processing-Test-Data-Set" class="headerlink" title="4.2. Pre-processing Test Data Set"></a>4.2. Pre-processing Test Data Set</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">test_df[<span class="string">'due_date'</span>] = pd.to_datetime(test_df[<span class="string">'due_date'</span>])</span><br><span class="line">test_df[<span class="string">'effective_date'</span>] = pd.to_datetime(test_df[<span class="string">'effective_date'</span>])</span><br><span class="line"></span><br><span class="line">test_df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>loan_status</th>
      <th>Principal</th>
      <th>terms</th>
      <th>effective_date</th>
      <th>due_date</th>
      <th>age</th>
      <th>education</th>
      <th>Gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-08</td>
      <td>2016-10-07</td>
      <td>50</td>
      <td>Bechalor</td>
      <td>female</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>5</td>
      <td>PAIDOFF</td>
      <td>300</td>
      <td>7</td>
      <td>2016-09-09</td>
      <td>2016-09-15</td>
      <td>35</td>
      <td>Master or Above</td>
      <td>male</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21</td>
      <td>21</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-10</td>
      <td>2016-10-09</td>
      <td>43</td>
      <td>High School or Below</td>
      <td>female</td>
    </tr>
    <tr>
      <th>3</th>
      <td>24</td>
      <td>24</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-10</td>
      <td>2016-10-09</td>
      <td>26</td>
      <td>college</td>
      <td>male</td>
    </tr>
    <tr>
      <th>4</th>
      <td>35</td>
      <td>35</td>
      <td>PAIDOFF</td>
      <td>800</td>
      <td>15</td>
      <td>2016-09-11</td>
      <td>2016-09-25</td>
      <td>29</td>
      <td>Bechalor</td>
      <td>male</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test_df[<span class="string">'loan_status'</span>].value_counts()</span><br></pre></td></tr></table></figure>




<pre><code>PAIDOFF       40
COLLECTION    14
Name: loan_status, dtype: int64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">test_df[<span class="string">'dayofweek'</span>] = test_df[<span class="string">'effective_date'</span>].dt.dayofweek</span><br><span class="line">test_df[<span class="string">'weekend'</span>] = test_df[<span class="string">'dayofweek'</span>].apply(<span class="keyword">lambda</span> x: <span class="number">1</span> <span class="keyword">if</span> x &gt; <span class="number">3</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">test_df[<span class="string">'Gender'</span>].replace(to_replace=[<span class="string">'male'</span>,<span class="string">'female'</span>], value=[<span class="number">0</span>,<span class="number">1</span>], inplace = <span class="literal">True</span>)</span><br><span class="line">test_df.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>loan_status</th>
      <th>Principal</th>
      <th>terms</th>
      <th>effective_date</th>
      <th>due_date</th>
      <th>age</th>
      <th>education</th>
      <th>Gender</th>
      <th>dayofweek</th>
      <th>weekend</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-08</td>
      <td>2016-10-07</td>
      <td>50</td>
      <td>Bechalor</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>5</td>
      <td>PAIDOFF</td>
      <td>300</td>
      <td>7</td>
      <td>2016-09-09</td>
      <td>2016-09-15</td>
      <td>35</td>
      <td>Master or Above</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21</td>
      <td>21</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-10</td>
      <td>2016-10-09</td>
      <td>43</td>
      <td>High School or Below</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>24</td>
      <td>24</td>
      <td>PAIDOFF</td>
      <td>1000</td>
      <td>30</td>
      <td>2016-09-10</td>
      <td>2016-10-09</td>
      <td>26</td>
      <td>college</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>35</td>
      <td>35</td>
      <td>PAIDOFF</td>
      <td>800</td>
      <td>15</td>
      <td>2016-09-11</td>
      <td>2016-09-25</td>
      <td>29</td>
      <td>Bechalor</td>
      <td>0</td>
      <td>6</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">test_Feature = test_df[[<span class="string">'Principal'</span>,<span class="string">'terms'</span>,<span class="string">'age'</span>,<span class="string">'Gender'</span>,<span class="string">'weekend'</span>]]</span><br><span class="line">test_Feature = pd.concat([test_Feature, pd.get_dummies(test_df[<span class="string">'education'</span>])], axis = <span class="number">1</span>)</span><br><span class="line">test_Feature.drop([<span class="string">'Master or Above'</span>], axis = <span class="number">1</span>, inplace = <span class="literal">True</span>)</span><br><span class="line">test_Feature.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Principal</th>
      <th>terms</th>
      <th>age</th>
      <th>Gender</th>
      <th>weekend</th>
      <th>Bechalor</th>
      <th>High School or Below</th>
      <th>college</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1000</td>
      <td>30</td>
      <td>50</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>300</td>
      <td>7</td>
      <td>35</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1000</td>
      <td>30</td>
      <td>43</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1000</td>
      <td>30</td>
      <td>26</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>800</td>
      <td>15</td>
      <td>29</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X_test = preprocessing.StandardScaler().fit(test_Feature).transform(test_Feature)</span><br><span class="line">X_test[<span class="number">0</span>:<span class="number">5</span>]</span><br></pre></td></tr></table></figure>




<pre><code>array([[ 0.49362588,  0.92844966,  3.05981865,  1.97714211, -1.30384048,
         2.39791576, -0.79772404, -0.86135677],
       [-3.56269116, -1.70427745,  0.53336288, -0.50578054,  0.76696499,
        -0.41702883, -0.79772404, -0.86135677],
       [ 0.49362588,  0.92844966,  1.88080596,  1.97714211,  0.76696499,
        -0.41702883,  1.25356634, -0.86135677],
       [ 0.49362588,  0.92844966, -0.98251057, -0.50578054,  0.76696499,
        -0.41702883, -0.79772404,  1.16095912],
       [-0.66532184, -0.78854628, -0.47721942, -0.50578054,  0.76696499,
         2.39791576, -0.79772404, -0.86135677]])</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y_test = test_df[<span class="string">'loan_status'</span>].values</span><br><span class="line">y_test[<span class="number">0</span>:<span class="number">5</span>]</span><br></pre></td></tr></table></figure>




<pre><code>array([&apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;],
      dtype=object)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y_test</span><br></pre></td></tr></table></figure>




<pre><code>array([&apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;,
       &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;,
       &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;,
       &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;,
       &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;,
       &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;,
       &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;PAIDOFF&apos;, &apos;COLLECTION&apos;,
       &apos;COLLECTION&apos;, &apos;COLLECTION&apos;, &apos;COLLECTION&apos;, &apos;COLLECTION&apos;,
       &apos;COLLECTION&apos;, &apos;COLLECTION&apos;, &apos;COLLECTION&apos;, &apos;COLLECTION&apos;,
       &apos;COLLECTION&apos;, &apos;COLLECTION&apos;, &apos;COLLECTION&apos;, &apos;COLLECTION&apos;,
       &apos;COLLECTION&apos;], dtype=object)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kNByhat = kNeighbor.predict(X_test)</span><br><span class="line">dTreeYhat = loanTree.predict(X_test)</span><br><span class="line">svmYhat = svm_Model.predict(X_test)</span><br><span class="line">lrYhat = LR_Model.predict(X_test)</span><br><span class="line">lrYhat_prob = LR_Model.predict_proba(X_test)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">data = []</span><br><span class="line">idx = [<span class="string">'KNN'</span>, <span class="string">'Decision Tree'</span>, <span class="string">'SVM'</span>,<span class="string">'LogisticRegression'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> yhat, Model_Name <span class="keyword">in</span> zip([kNByhat, dTreeYhat, svmYhat, lrYhat],idx ):</span><br><span class="line">    </span><br><span class="line"><span class="comment">#     jaccard = jaccard_score(y_test, yhat, average = None )[-1]</span></span><br><span class="line">    jaccard = jaccard_similarity_score ( y_test, yhat)</span><br><span class="line">    </span><br><span class="line">    F1 = f1_score(y_test, yhat, average=<span class="string">'weighted'</span>)</span><br><span class="line">    </span><br><span class="line">    data.append(&#123;<span class="string">'Jaccard'</span>: jaccard,</span><br><span class="line">                 <span class="string">'F1-score'</span>:F1,</span><br><span class="line">                &#125;)</span><br><span class="line">    print(<span class="string">'&#123;&#125;'</span>.format(<span class="string">'-'</span>*<span class="number">42</span>))</span><br><span class="line">    print(<span class="string">'&#123;:&lt;21&#125; Jaccard index: &#123;:.2f&#125;'</span>.format(Model_Name, jaccard))</span><br><span class="line">    print(<span class="string">'&#123;:&lt;21&#125;      F1-score: &#123;:.2f&#125;'</span>.format(<span class="string">''</span>,F1))</span><br><span class="line">    </span><br><span class="line">data[<span class="number">-1</span>][<span class="string">'LogLoss'</span>] = log_loss(y_test, lrYhat_prob)</span><br><span class="line">print(<span class="string">'&#123;:&lt;21&#125;       LogLoss: &#123;:.2f&#125;'</span>.format(<span class="string">''</span>,data[<span class="number">-1</span>][<span class="string">'LogLoss'</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>------------------------------------------
KNN                   Jaccard index: 0.67
                           F1-score: 0.63
------------------------------------------
Decision Tree         Jaccard index: 0.72
                           F1-score: 0.74
------------------------------------------
SVM                   Jaccard index: 0.80
                           F1-score: 0.76
------------------------------------------
LogisticRegression    Jaccard index: 0.74
                           F1-score: 0.66
                            LogLoss: 0.57</code></pre><h1 id="5-Summary"><a href="#5-Summary" class="headerlink" title="5. Summary"></a>5. Summary</h1><p>You should be able to report the accuracy of the built model using different evaluation metrics:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">accuracy_report = pd.DataFrame(data, </span><br><span class="line">                         index = [<span class="string">'KNN'</span>, <span class="string">'Decision Tree'</span>, <span class="string">'SVM'</span>,<span class="string">'LogisticRegression'</span>],</span><br><span class="line">                         columns = [<span class="string">'Jaccard'</span>,<span class="string">'F1-score'</span>,<span class="string">'LogLoss'</span>],</span><br><span class="line">                        )</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pd.set_option(<span class="string">'precision'</span>, <span class="number">2</span>)</span><br><span class="line">accuracy_report</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Jaccard</th>
      <th>F1-score</th>
      <th>LogLoss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>KNN</th>
      <td>0.67</td>
      <td>0.63</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Decision Tree</th>
      <td>0.72</td>
      <td>0.74</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SVM</th>
      <td>0.80</td>
      <td>0.76</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>LogisticRegression</th>
      <td>0.74</td>
      <td>0.66</td>
      <td>0.57</td>
    </tr>
  </tbody>
</table>
</div>



<h2>Want to learn more?</h2>

<p>IBM SPSS Modeler is a comprehensive analytics platform that has many machine learning algorithms. It has been designed to bring predictive intelligence to decisions made by individuals, by groups, by systems – by your enterprise as a whole. A free trial is available through this course, available here: <a href="http://cocl.us/ML0101EN-SPSSModeler" target="_blank" rel="noopener">SPSS Modeler</a></p>
<p>Also, you can use Watson Studio to run these notebooks faster with bigger datasets. Watson Studio is IBM’s leading cloud solution for data scientists, built by data scientists. With Jupyter notebooks, RStudio, Apache Spark and popular libraries pre-packaged in the cloud, Watson Studio enables data scientists to collaborate on their projects without having to install anything. Join the fast-growing community of Watson Studio users today with a free account at <a href="https://cocl.us/ML0101EN_DSX" target="_blank" rel="noopener">Watson Studio</a></p>
<h3>Thanks for completing this lesson!</h3>

<h4>Author:  <a href="https://ca.linkedin.com/in/saeedaghabozorgi" target="_blank" rel="noopener">Saeed Aghabozorgi</a></h4>
<p><a href="https://ca.linkedin.com/in/saeedaghabozorgi" target="_blank" rel="noopener">Saeed Aghabozorgi</a>, PhD is a Data Scientist in IBM with a track record of developing enterprise level applications that substantially increases clients’ ability to turn data into actionable knowledge. He is a researcher in data mining field and expert in developing advanced analytic methods like machine learning and statistical modelling on large datasets.</p>

<hr>

<p>Copyright &copy; 2018 <a href="https://cocl.us/DX0108EN_CC" target="_blank" rel="noopener">Cognitive Class</a>. This notebook and its source code are released under the terms of the <a href="https://bigdatauniversity.com/mit-license/" target="_blank" rel="noopener">MIT License</a>.</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>Bin Yu
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://binyuonca.github.io/2020/07/08/Classification-with-Python/" title="Classification with Python">https://binyuonca.github.io/2020/07/08/Classification-with-Python/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Python/" rel="tag"># Python</a>
              <a href="/tags/Classification/" rel="tag"># Classification</a>
              <a href="/tags/Pandas/" rel="tag"># Pandas</a>
              <a href="/tags/seaborn/" rel="tag"># seaborn</a>
              <a href="/tags/Coursera/" rel="tag"># Coursera</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item"></div>
      <div class="post-nav-item">
    <a href="/2020/07/21/Business-Location-Options-in-Toronto/" rel="next" title="Anomaly Detection For Location Problem">
      Anomaly Detection For Location Problem <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-Environment-And-Dataset"><span class="nav-number">1.</span> <span class="nav-text">1. Environment And Dataset</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-About-Dataset"><span class="nav-number">1.1.</span> <span class="nav-text">1.1. About Dataset</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-Load-Data-From-CSV-File"><span class="nav-number">1.2.</span> <span class="nav-text">1.2. Load Data From CSV File</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-Convert-To-Date-Time-Object"><span class="nav-number">1.3.</span> <span class="nav-text">1.3. Convert To Date Time Object</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-Pre-processing-With-Data-Visualization"><span class="nav-number">2.</span> <span class="nav-text">2. Pre-processing With Data Visualization</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-Visulaition-The-Data"><span class="nav-number">2.1.</span> <span class="nav-text">2.1. Visulaition The Data</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-Categorical-Encoding"><span class="nav-number">2.2.</span> <span class="nav-text">2.2. Categorical Encoding</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-1-Gender"><span class="nav-number">2.2.1.</span> <span class="nav-text">2.2.1. Gender</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-2-Education"><span class="nav-number">2.2.2.</span> <span class="nav-text">2.2.2. Education</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-Feature-Selection"><span class="nav-number">2.3.</span> <span class="nav-text">2.3. Feature Selection</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-Normalize-Data"><span class="nav-number">2.4.</span> <span class="nav-text">2.4. Normalize Data</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-Classification"><span class="nav-number">3.</span> <span class="nav-text">3. Classification</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-K-Nearest-Neighbor-KNN"><span class="nav-number">3.1.</span> <span class="nav-text">3.1. K Nearest Neighbor(KNN)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-Decision-Tree"><span class="nav-number">3.2.</span> <span class="nav-text">3.2. Decision Tree</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-Support-Vector-Machine"><span class="nav-number">3.3.</span> <span class="nav-text">3.3. Support Vector Machine</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-Logistic-Regression"><span class="nav-number">3.4.</span> <span class="nav-text">3.4. Logistic Regression</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-Model-Evaluation-Using-Test-Data-Set"><span class="nav-number">4.</span> <span class="nav-text">4. Model Evaluation Using Test Data Set</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-Load-Test-Data-Set-For-Evaluation"><span class="nav-number">4.1.</span> <span class="nav-text">4.1. Load Test Data Set For Evaluation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-Pre-processing-Test-Data-Set"><span class="nav-number">4.2.</span> <span class="nav-text">4.2. Pre-processing Test Data Set</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-Summary"><span class="nav-number">5.</span> <span class="nav-text">5. Summary</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#"><span class="nav-number">5.1.</span> <span class="nav-text">Want to learn more?</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#"><span class="nav-number">5.1.1.</span> <span class="nav-text">Thanks for completing this lesson!</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#"><span class="nav-number">5.1.1.1.</span> <span class="nav-text">Author:  Saeed Aghabozorgi</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Bin Yu"
      src="/images/Ben_Marathon_Mississauga.gif">
  <p class="site-author-name" itemprop="name">Bin Yu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/BinYuOnCa" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;BinYuOnCa" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bin Yu</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        




  <script src="https://www.gstatic.com/firebasejs/6.3.3/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.3.3/firebase-firestore.js"></script>
  <script>
    firebase.initializeApp({
      apiKey   : 'githubblog-3fdfe',
      projectId: 'AIzaSyC5RnRX7KzELx-7Pt1p-mQgUWNwf84k7gk'
    });

    function getCount(doc, increaseCount) {
      // IncreaseCount will be false when not in article page
      return doc.get().then(d => {
        var count = 0;
        if (!d.exists) { // Has no data, initialize count
          if (increaseCount) {
            doc.set({
              count: 1
            });
            count = 1;
          }
        } else { // Has data
          count = d.data().count;
          if (increaseCount) {
            // If first view this article
            doc.set({ // Increase count
              count: count + 1
            });
            count++;
          }
        }

        return count;
      });
    }

    function appendCountTo(el) {
      return count => {
        el.innerText = count;
      }
    }
  </script>
  <script>
    (function() {
      var db = firebase.firestore();
      var articles = db.collection('articles');

      if (CONFIG.page.isPost) { // Is article page
        var title = document.querySelector('.post-title').innerText.trim();
        var doc = articles.doc(title);
        var increaseCount = CONFIG.hostname === location.hostname;
        if (localStorage.getItem(title)) {
          increaseCount = false;
        } else {
          // Mark as visited
          localStorage.setItem(title, true);
        }
        getCount(doc, increaseCount).then(appendCountTo(document.querySelector('.firestore-visitors-count')));
      } else if (CONFIG.page.isHome) { // Is index page
        var promises = [...document.querySelectorAll('.post-title')].map(element => {
          var title = element.innerText.trim();
          var doc = articles.doc(title);
          return getCount(doc);
        });
        Promise.all(promises).then(counts => {
          var metas = document.querySelectorAll('.firestore-visitors-count');
          counts.forEach((val, idx) => {
            appendCountTo(metas[idx])(val);
          });
        });
      }
    })();
  </script>


<script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              Counter('post', '/classes/Counter', { title, url, time: 1 })
                .then(response => response.json())
                .then(() => {
                  leancloudSelector(url).innerText = 1;
                })
                .catch(error => {
                  console.error('Failed to create', error);
                });
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":"flase","app_id":"PFfDnND4aRCqfyvyNs3I5zeB-MdYXbMMI","app_key":"SmRgM6YQLDJp6vPh8lddYsDQ","server_url":"binyuonca.github.io","security":false,"betterPerformance":false};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>


      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'xAbyCllSgFTWSsFRMXGpWyb3-MdYXbMMI',
      appKey     : 'FdlB5jPO98iemWpRJPcK4Rpc',
      placeholder: "Make your comments here. Thank you.",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
